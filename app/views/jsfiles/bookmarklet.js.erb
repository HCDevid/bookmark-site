$(function (){
	var newSS, styles='#bookmarklet * {margin:4px;} #bookmarklet {background: #A6FFAD;font-size:10px;border-radius: 10px;border: 1px solid;width: 300px;top: 5px;right: 30%;position:fixed;z-index:999998;} #bookmarklet  .floatright {float:right;}';
	if(document.createStyleSheet) { 
		document.createStyleSheet("javascript:'"+styles+"'");
	}
	else {
		newSS=document.createElement('link'); 
		newSS.rel='stylesheet';
		newSS.href='data:text/css,'+escape(styles);
		document.getElementsByTagName("head")[0].appendChild(newSS);
	}
	$('body').append('<div id="bookmarklet"><div>');
	$('#bookmarklet').html("<%=j render 'bookmarklet_content' %>");
	$.ajaxSetup({
	  headers: {'Origin': "*"}
	});
	$('#bookmarklet').on('click', 'a.submit_link', function(){
		$(this).parents('#bookmarklet form').submit();
	}).on('ajax:beforeSubmit', '#bookmarklet a.submit_link', function(event, data, status, xhr){
			console.log(xhr.getRequestHeader('origin'));
			// xhr.setRequestHeader('origin','http://localhost:3000');
	}).on('ajax:success', '#bookmarklet a.submit_link', function(event, xhr, settings){
			event.preventDefault()
			$(this).parents('#bookmarklet').remove();
			console.log(data);
	});
	$('#bookmarklet').on('click', 'a.floatright', function(){
		$(this).parents('#bookmarklet').remove();
	});
});